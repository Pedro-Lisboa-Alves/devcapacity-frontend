@page
@model DevCapacityWebApp.Pages.Initiatives.EditModel
@await Html.PartialAsync("_Tabs")

<h3>Edit Initiative</h3>

<form method="post" class="mb-3">
  <input type="hidden" asp-for="Initiative.InitiativeId" />
  <div class="mb-2">
    <input class="form-control" asp-for="Initiative.Name" placeholder="Name" />
  </div>

  <div class="row g-2 mb-2">
    <div class="col-md-3">
      <label class="form-label">Status</label>
      <select class="form-select" asp-for="Initiative.Status" name="Initiative.Status">
        <option value="">-- Select Status --</option>
        @if (Model.Statuses != null)
        {
          @foreach (var s in Model.Statuses)
          {
            if (s.StatusId == Model.Initiative.Status)
            {
              <option value="@s.StatusId" selected="selected">@s.Name</option>
            }
            else
            {
              <option value="@s.StatusId">@s.Name</option>
            }
          }
        }
      </select>
    </div>

    <div class="col-md-3">
      <label class="form-label">PDs</label>
      <input class="form-control" type="number" asp-for="Initiative.PDs" placeholder="PDs" />
    </div>
    <div class="col-md-3">
      <label class="form-label">Start Date</label>
      <input class="form-control" type="date" asp-for="Initiative.StartDate" />
    </div>
    <div class="col-md-3">
      <label class="form-label">End Date</label>
      <input class="form-control" type="date" asp-for="Initiative.EndDate" />
    </div>
  </div>

  <div class="d-flex gap-2">
    <button class="btn btn-primary" type="submit">Save</button>
    <a class="btn btn-secondary" href="/Initiatives">Cancel</a>
  </div>
</form>

<hr />

<h4>Tasks in this Initiative</h4>
@if (Model.Tasks == null || Model.Tasks.Count == 0)
{
  <p class="text-muted">No tasks in this initiative.</p>
}
else
{
  <div class="table-responsive">
    <table class="table table-sm">
      <thead><tr><th>Id</th><th>Title</th><th></th></tr></thead>
      <tbody>
        @foreach(var t in Model.Tasks)
        {
          <tr>
            <td>@t.Id</td>
            <td>@t.Title</td>
            <td>
              <a class="btn btn-sm btn-secondary" href="/Tasks/Edit?id=@t.Id">Edit</a>
            </td>
          </tr>
        }
      </tbody>
    </table>
  </div>
}